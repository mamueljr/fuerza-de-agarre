<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Continuar Encuesta</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/styles.css" />
  </head>
  <body>
    <h1>Continuar Encuesta Pendiente</h1>

    <div id="listaPendientes" class="lista"></div>

    <button onclick="location.href='../index.html'">⬅️ Volver al menú</button>

    <footer>ESISCOM &copy; 2025</footer>

    <script>
      const listaContenedor = document.getElementById("listaPendientes");
      const encuestados = JSON.parse(
        localStorage.getItem("encuestados") || "[]"
      );

      const pendientes = encuestados.filter(
        (e) => !e.sf36 || !e.seniorFitness || !e.folstein || !e.dinamometria
      );

      if (pendientes.length === 0) {
        listaContenedor.innerHTML = "<p>No hay encuestas pendientes.</p>";
      } else {
        pendientes.forEach((e) => {
          const estado = [];
          if (e.sf36) estado.push("✅ SF-36");
          else estado.push("❌ SF-36");
          if (e.seniorFitness) estado.push("✅ Senior Fitness");
          else estado.push("❌ Senior Fitness");
          if (e.folstein) estado.push("✅ Folstein");
          else estado.push("❌ Folstein");
          if (e.dinamometria) estado.push("✅ Dinamometría");
          else estado.push("❌ Dinamometría");

          const div = document.createElement("div");
          div.className = "card";
          div.innerHTML = `
          <strong>ID:</strong> ${e.id}<br>
          <strong>Edad:</strong> ${e.edad} | <strong>Sexo:</strong> ${
            e.sexo
          }<br>
          <p>${estado.join(" | ")}</p>
          <button onclick="continuar('${e.id}')">Continuar</button>
        `;
          listaContenedor.appendChild(div);
        });
      }

      function continuar(id) {
        localStorage.setItem("encuestadoActual", id);
        // Aquí puedes decidir a qué encuesta redirigir según el avance
        const encuestado = encuestados.find((e) => e.id === id);

        if (!encuestado.sf36) location.href = "sf36.html";
        else if (!encuestado.seniorFitness)
          location.href = "senior_fitness.html";
        else if (!encuestado.folstein) location.href = "folstein.html";
        else if (!encuestado.dinamometria) location.href = "dinamometria.html";
      }
    </script>
  </body>
</html>
